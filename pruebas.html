<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOME PAGE</title>

    <!-- LINKS A CSS -->
    <link rel="stylesheet" href="css/general.css">

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-..." crossorigin="anonymous">

    <!-- FUENTES -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

</head>
<body>

    <h1>BUENAS</h1>

    <script>
        // Variables de la API
        const API_URL = 'https://api.freecurrencyapi.com/v1/latest';
        const API_KEY = 'fca_live_BFxDuIPgRfeyednKIiQhUNOwNlP3p21N7XxYxhhA';

        // Función para encontrar todas las conversiones posibles
        async function conversiones(baseCurrency) {
            try {
                // Crear y ejecutar la URL con la moneda base
                const url = `${API_URL}?apikey=${API_KEY}&base_currency=${baseCurrency}`;
                const respuesta = await fetch(url);

                // Verificar la respuesta
                if (!respuesta.ok) {
                    throw new Error(`Error: ${respuesta.statusText}`);
                }

                // Convertir los datos a JSON
                const data = await respuesta.json();

                // Imprimir todas las conversiones posibles
                console.log(`Tasas de conversión disponible para: ${baseCurrency}`);
                console.log(data.data);
                return data.data;

            } catch (error) {
                console.error("Error al obtener las conversiones:", error);
                return null;
            }
        }

        // Función para convertir moneda
        async function convertir(cantidad, fromCurrency, toCurrency) {
            try {
                // Crear y ejecutar la URL con la moneda base
                const url = `${API_URL}?apikey=${API_KEY}&base_currency=${fromCurrency}`;
                const respuesta = await fetch(url);

                // Verificar la respuesta
                if (!respuesta.ok) {
                    throw new Error(`Error: ${respuesta.statusText}`);
                }

                // Convertir los datos a JSON
                const data = await respuesta.json();

                // Extraer la conversión
                const conversion = data.data[toCurrency];
                if (!conversion) {
                    throw new Error(`No hay tasa de cambio para: ${toCurrency}`);
                }

                // Calcular el precio final con el inicial y la conversión
                const precioFinal = cantidad * conversion;

                console.log(`El precio final de ${cantidad} ${fromCurrency} es: ${precioFinal.toFixed(2)} ${toCurrency}`);
                return precioFinal;

            } catch (error) {
                console.error("Error durante la conversión:", error);
                return null;
            }
        }



        // Llamar a la función al cargar la página
        window.onload = async () => {

            const resultadoConversiones = await conversiones('EUR');
            if(resultadoConversiones !== null){
                console.log("Tasas de cambio cargadas.");
            }else{
                console.log("Hubo un error al cargar las tasas de cambio.");
            }


            const resultadoConvertir = await convertir(15, 'EUR', 'USD');
            if (resultadoConvertir !== null) {
                console.log("Conversión completada con éxito.");
            } else {
                console.log("Hubo un error durante la conversión.");
            }
        };
    </script>

    <!-- Bootstrap Bundle with Popper (JS) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

</body>
</html>