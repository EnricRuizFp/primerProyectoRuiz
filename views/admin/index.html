<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADMIN</title>

    <!-- LINKS A CSS -->
    <link rel="stylesheet" href="css/general.css">
    <link rel="stylesheet" href="css/admin.css">

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

    <!-- FUENTES -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

</head>
<body>
    
    <div class="container-fluid">
        <div class="row">

            <div id="tituloAdmin" class="col-12">
                <h2>PANEL DE ADMINISTRADOR <a class="p5" href="?controller=admin">reload</a></h2>
            </div>

            <div id="lateralPanel" class="col-2">
                <button id="botonObtenerAllPedidos" class="botonesLaterales" type="button">PEDIDOS</button>
                <button id="botonObtenerAllUsuarios" class="botonesLaterales" type="button">USUARIOS</button>
                <button id="botonObtenerAllProductos" class="botonesLaterales" type="button">PRODUCTOS</button>
                <button id="botonObtenerAllIngredientes" class="botonesLaterales" type="button">INGREDIENTES</button>
                <button id="botonObtenerAllOfertas" class="botonesLaterales" type="button">OFERTAS</button>
                    <br><br><br><br>
                <p>Seleccione una divisa</p>
                <select id="selectorDivisas">
                    <option value="" disabled>Elige una moneda</option>
                </select>
                
            </div>

            <div id="contenedorPrincipal" class="col-10">

                <div id="contenedorDefault" class="container-fluid">
                    <p class="p3">Ha accedido al panel de administrador.</p>
                    <p class="p4">Seleccione una de las opciones de la izquierda.</p>

                    <div id="datosTotales" class="row">
                        <h5>Totales</h5>

                        <div class="col-6">
                            <div id="datosPedidos" class="contenedorDatosTotales"></div>
                        </div>
                        <div class="col-6">
                            <div id="datosUsuarios" class="contenedorDatosTotales"></div>
                        </div>
                        <div class="col-6">
                            <div id="datosProductos" class="contenedorDatosTotales"></div>
                        </div>
                        <div class="col-6">
                            <div id="datosIngredientes" class="contenedorDatosTotales"></div>
                        </div>

                        <h5 id="tituloLogs">LOGS</h5>
                        <p>(Los más recientes primero)</p>
                        
                        <div class="col-12 container-fluid" class="contenedorDatosTotales">

                            <div class="row">
                                <div class="col-3"><p class="p3">Acción</p></div>
                                <div class="col-3"><p class="p3">ID (si aplica)</p></div>
                                <div class="col-3"><p class="p3">TABLA</p></div>
                                <div class="col-3"><p class="p3">FECHA</p></div>
                            </div>

                            <div id="datosLogs"></div>
                        </div>
                        

                    </div>

                </div>

                <!-- CONTENEDOR PEDIDOS -->
                <div id="contenedorPedidos" class="container-fluid">
                    
                    <!-- Boton crear pedido -->
                    <button type="button" class="btn btn-primary botonAñadir" onclick="crearPedido()">
                        Crear Pedido
                    </button>

                    <!-- Botones de filtros -->
                    <button type="button" class="btn btn-primary" onclick="filtrarPorUsuario()">
                        Filtrar por usuario
                    </button>
                    <button type="button" class="btn btn-primary" onclick="filtrarPorFecha()">
                        Filtrar por fecha
                    </button>
                    <button type="button" class="btn btn-primary" onclick="filtrarPorPrecio()">
                        Filtrar por precio
                    </button>

                    <!-- Modal Crear pedido -->
                    <div class="modal fade" id="modalCrearPedido" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCrearPedido" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="añadir_cliente_id" class="form-label">Cliente</label>
                                            <input type="number" id="añadir_cliente_id" name="añadir_cliente_id" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_oferta_id" class="form-label">Oferta</label>
                                            <input type="number" id="añadir_oferta_id" name="añadir_oferta_id" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_fecha" class="form-label">Fecha</label>
                                            <input type="date" id="añadir_fecha" name="añadir_fecha" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_direccion" class="form-label">Dirección</label>
                                            <input type="number" id="añadir_direccion" name="añadir_direccion" class="form-control">
                                        </div>

                                        <h7>Añadir productos</h7>

                                        <!-- Select de productos -->
                                        <div class="mb-3">
                                            <label for="productSelect" class="form-label">Producto</label>
                                            <select id="productSelect" class="form-select">
                                            </select>
                                        </div>
                                        <!-- Cantidad -->
                                        <div class="mb-3">
                                            <label for="productQuantity" class="form-label">Cantidad</label>
                                            <input type="number" id="productQuantity" class="form-control" min="1" placeholder="Cantidad">
                                        </div>
                                        <!-- Botón para añadir producto -->
                                        <div class="mb-3">
                                            <button type="button" id="addProductBtn" class="btn btn-success">Añadir Producto</button>
                                        </div>
                                        <!-- Tabla de productos seleccionados -->
                                        <div>
                                            <h8>Productos seleccionados:</h8>
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Producto</th>
                                                        <th>Cantidad</th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="productTableBody">
                                                    <!-- Productos añadidos dinámicamente -->
                                                </tbody>
                                            </table>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="crearPedido" id="crearPedido" class="btn btn-success" value="Crear pedido">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Editar pedido -->
                    <div class="modal fade" id="modalEditarPedido" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Editar pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioEditarPedido" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="number" id="editar_pedido_id" name="editar_pedido_id" class="form-control" hidden>

                                        <div class="mb-3">
                                            <label for="editar_cliente_id" class="form-label">Cliente</label>
                                            <input type="number" id="editar_cliente_id" name="editar_cliente_id" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_oferta_id" class="form-label">Oferta</label>
                                            <input type="number" id="editar_oferta_id" name="editar_oferta_id" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_fecha" class="form-label">Fecha</label>
                                            <input type="date" id="editar_fecha" name="editar_fecha" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_direccion" class="form-label">Dirección</label>
                                            <input type="number" id="editar_direccion" name="editar_direccion" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="selectEstado" class="form-label">Estado del pedido</label>
                                            <select id="selectEstado" class="form-select">
                                                <option value="pendiente">Pendiente</option>
                                                <option value="preparando">En preparación</option>
                                                <option value="repartiendo">En reparto</option>
                                                <option value="entregado">Entregado</option>
                                                <option value="denegado">Denegado</option>
                                            </select>
                                        </div>

                                        <h7>Añadir productos</h7>

                                        <!-- Select de productos -->
                                        <div class="mb-3">
                                            <label for="productSelectEdit" class="form-label">Producto</label>
                                            <select id="productSelectEdit" class="form-select">
                                            </select>
                                        </div>
                                        <!-- Cantidad -->
                                        <div class="mb-3">
                                            <label for="productQuantity" class="form-label">Cantidad</label>
                                            <input type="number" id="productQuantityEdit" class="form-control" min="1" placeholder="Cantidad">
                                        </div>
                                        <!-- Botón para añadir producto -->
                                        <div class="mb-3">
                                            <button type="button" id="addProductBtnEdit" class="btn btn-success">Añadir Producto</button>
                                        </div>
                                        <!-- Tabla de productos seleccionados -->
                                        <div>
                                            <h8>Productos seleccionados:</h8>
                                            <table class="table">
                                                <thead>
                                                    <tr>
                                                        <th>Producto</th>
                                                        <th>Cantidad</th>
                                                        <th>Acciones</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="productTableBodyEdit">
                                                    <!-- Productos añadidos dinámicamente -->
                                                </tbody>
                                            </table>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="editarPedido" id="editarPedido" class="btn btn-success" value="Editar pedido">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Ver Productos -->
                    <div class="modal fade" id="modalVerProductos" tabindex="-1" role="dialog" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Productos del pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <div class="modal-body container-fluid">
                                    <div id="tablaProductos" class="row">
                                        <div class="col-3">
                                            <p class="p3">Producto</p>
                                        </div>
                                        <div class="col-3">
                                            <p class="p3">Cantidad</p>
                                        </div>
                                        <div class="col-3">
                                            <p class="p3">Precio unidad</p>
                                        </div>
                                        <div class="col-3">
                                            <p class="p3">Precio</p>
                                        </div>
                                    </div>

                                    <div id="contenidoTablaProductos"></div>
                                </div>

                                <div class="modal-footer">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtrar Por Usuario -->
                    <div class="modal fade" id="modalFiltroUsuario" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroUsuario" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <!-- Select de productos -->
                                        <div class="mb-3">
                                            <label for="usuarioSelect" class="form-label">Usuario</label>
                                            <select id="usuarioSelect" class="form-select">
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarPorUsuario" id="filtrarPorUsuario" class="btn btn-success" value="Filtrar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtrar Por Fechas -->
                    <div class="modal fade" id="modalFiltroFecha" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroFecha" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <!-- Select de fechas -->
                                        <div class="mb-3">
                                            <label for="filtrar_fecha_inicio" class="form-label">Fecha de inicio</label>
                                            <input type="date" id="filtrar_fecha_inicio" name="filtrar_fecha_inicio" class="form-control">
                                        </div>
                                        <div class="mb-3">
                                            <label for="filtrar_fecha_fin" class="form-label">Fecha de fin</label>
                                            <input type="date" id="filtrar_fecha_fin" name="filtrar_fecha_fin" class="form-control">
                                        </div>

                                        <!-- Select de orden -->
                                        <div class="mb-3">
                                            <label for="orden_filtro_fecha" class="form-label">Fecha de fin</label>
                                            <select id="orden_filtro_fecha" name="orden_filtro_fecha" class="form-select">
                                                <option value="DESC">Descendiente</option>
                                                <option value="ASC">Ascendiente</option>
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarPorFecha" id="filtrarPorFecha" class="btn btn-success" value="Filtrar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtrar Por Precio -->
                    <div class="modal fade" id="modalFiltroPrecio" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear pedido</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroPrecio" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <!-- Select de fechas -->
                                        <div class="mb-3">
                                            <label for="filtrar_precio_inicio" class="form-label">Precio de inicio</label>
                                            <input type="number" id="filtrar_precio_inicio" name="filtrar_precio_inicio" class="form-control">
                                        </div>
                                        <div class="mb-3">
                                            <label for="filtrar_precio_fin" class="form-label">Precio de fin</label>
                                            <input type="number" id="filtrar_precio_fin" name="filtrar_precio_fin" class="form-control">
                                        </div>

                                        <!-- Select de orden -->
                                        <div class="mb-3">
                                            <label for="orden_filtro_precio" class="form-label">Fecha de fin</label>
                                            <select id="orden_filtro_precio" name="orden_filtro_precio" class="form-select">
                                                <option value="DESC">Descendiente</option>
                                                <option value="ASC">Ascendiente</option>
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarPorPrecio" id="filtrarPorPrecio" class="btn btn-success" value="Filtrar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <div id="tablaPedidos">
                        <div class="tituloTable row">
                            <div class="col-1">
                                <p class="h4">ID</p>
                            </div>
                            <div class="col-3">
                                <p class="h4">Productos</p>
                            </div>
                            <div class="col-1">
                                <p class="h4">Precio</p>
                            </div>
                            <div class="col-4">
                                <p class="h4">Datos entrega</p>
                            </div>
                            <div class="col-1">
                                <p class="h4">Estado</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Acciones</p>
                            </div>
                        </div>

                        <div id="contenedorDatosPedidos"></div>

                    </div>

                </div>

                <!-- CONTENEDOR USUARIOS -->
                <div id="contenedorUsuarios" class="container-fluid">

                    <!-- Boton agregar usuario -->
                    <button type="button" class="btn btn-primary botonAñadir" data-bs-toggle="modal" data-bs-target="#modalAñadirUsuario">
                        Añadir Usuario
                    </button>

                    <!-- Modal Crear usuario -->
                    <div class="modal fade" id="modalAñadirUsuario" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear usuario</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCrearUsuario" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="añadir_usuario" class="form-label">Usuario</label>
                                            <input type="text" id="añadir_usuario" name="añadir_usuario" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_nombre_completo" class="form-label">Nombre completo</label>
                                            <input type="text" id="añadir_nombre_completo" name="añadir_nombre_completo" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_email" class="form-label">Email</label>
                                            <input type="email" id="añadir_email" name="añadir_email" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_telefono" class="form-label">Teléfono</label>
                                            <input type="number" id="añadir_telefono" name="añadir_telefono" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_contraseña" class="form-label">Contraseña</label>
                                            <input type="password" id="añadir_contraseña" name="añadir_contraseña" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_tarjeta_bancaria" class="form-label">Tarjeta bancaria</label>
                                            <input type="text" id="añadir_tarjeta_bancaria" name="añadir_tarjeta_bancaria" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_fecha_vencimiento" class="form-label">Fecha de vencimiento</label>
                                            <input type="date" id="añadir_fecha_vencimiento" name="añadir_fecha_vencimiento" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_cvv" class="form-label">CVV</label>
                                            <input type="number" id="añadir_cvv" name="añadir_cvv" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="crearUsuario" id="crearUsuario" class="btn btn-success" value="Añadir">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Editar Usuario -->
                    <div class="modal fade" id="modalEditarUsuario" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalEditarUsuarioLabel">Editar Usuario</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioEditarUsuario" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="hidden" id="editar_id" name="id">

                                        <div class="mb-3">
                                            <label for="editar_usuario" class="form-label">Usuario</label>
                                            <input type="text" id="editar_usuario" name="usuario" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_nombre_completo" class="form-label">Nombre completo</label>
                                            <input type="text" id="editar_nombre_completo" name="nombre_completo" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_email" class="form-label">Email</label>
                                            <input type="email" id="editar_email" name="email" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_telefono" class="form-label">Teléfono</label>
                                            <input type="number" id="editar_telefono" name="telefono" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_tarjeta_bancaria" class="form-label">Tarjeta bancaria</label>
                                            <input type="text" id="editar_tarjeta_bancaria" name="tarjeta_bancaria" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_fecha_vencimiento" class="form-label">Fecha de vencimiento</label>
                                            <input type="date" id="editar_fecha_vencimiento" name="fecha_vencimiento" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_cvv" class="form-label">CVV</label>
                                            <input type="number" id="editar_cvv" name="cvv" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="editarUsuario" id="editarUsuario" class="btn btn-success" value="Guardar cambios">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Cambiar Contraseña -->
                    <div class="modal fade" id="modalCambiarContraseña" tabindex="-1" role="dialog" aria-labelledby="modalCambiarContraseña" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="modalEditarUsuarioLabel">Cambiar contraseña</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCambiarContraseña" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="hidden" id="cambiar_contraseña_id" name="id">

                                        <div class="mb-3">
                                            <label for="cambiar_contraseña" class="form-label">Nueva contraseña</label>
                                            <input type="text" id="cambiar_contraseña" name="cambiar_contraseña" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="action" id="cambiar_contraseña_action" class="btn btn-success" value="Guardar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- TABLA DE USUARIOS -->
                    <div id="tablaUsuarios">

                        <div class="tituloTable row">
                            <div class="col-1">
                                <p class="h4">ID</p>
                            </div>
                            <div class="col-5">
                                <p class="h4">Datos usuario</p>
                            </div>
                            <div class="col-4">
                                <p class="h4">Datos bancarios</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Acciones</p>
                            </div>
                        </div>
    
                        <div id="contenedorDatosUsuarios"></div>

                    </div>

                </div>

                <!-- CONTENEDOR PRODUCTOS -->
                <div id="contenedorProductos" class="container-fluid">

                    <button type="button" class="btn btn-primary botonAñadir" onclick="crearProducto()">
                        Crear Producto
                    </button>

                    <button type="button" class="btn btn-primary botonAñadir" data-bs-toggle="modal" data-bs-target="#modalFiltroSeccion">
                        Filtrar por sección
                    </button>

                    <!-- Modal Crear Producto -->
                    <div class="modal fade" id="modalCrearProducto" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear producto</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCrearProducto" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="añadir_nombre" class="form-label">Nombre</label>
                                            <input type="text" id="añadir_nombre" name="añadir_nombre" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_descripcion" class="form-label">Descripción</label>
                                            <input type="text" id="añadir_descripcion" name="añadir_descripcion" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_seccion" class="form-label">Sección</label>
                                            <select name="añadir_seccion" id="añadir_seccion" class="form-select">
                                                <option value="pizzas">Pizzas</option>
                                                <option value="bebidas">Bebidas</option>
                                                <option value="postres">Postres</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_ingredientes" class="form-label">Ingredientes</label>
                                            <select name="añadir_ingredientes[]" id="añadir_ingredientes" class="form-select" multiple>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_categoria" class="form-label">Categoría</label>
                                            <input type="text" id="añadir_categoria" name="añadir_categoria" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_precio" class="form-label">Precio</label>
                                            <input type="number" id="añadir_precio" step="0.01" name="añadir_precio" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_imagen" class="form-label">Imagen</label>
                                            <input type="text" id="añadir_imagen" name="añadir_imagen" class="form-control" placeholder="escribe la ruta en la que has pegado la imagen">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="crearProducto" id="crearProducto" class="btn btn-success" value="Crear">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtrar por Sección -->
                    <div class="modal fade" id="modalFiltroSeccion" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Filtrar productos</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroProductos" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="filtrar_seccion" class="form-label">Sección</label>
                                            <select name="filtrar_seccion" id="filtrar_seccion" class="form-select">
                                                <option value="pizzas">Pizzas</option>
                                                <option value="bebidas">Bebidas</option>
                                                <option value="postres">Postres</option>
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarProductos" id="filtrarProductos" class="btn btn-success" value="Filtrar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Editar Producto -->
                    <div class="modal fade" id="modalEditarProducto" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Editar producto</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioEditarProducto" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="text" id="editar_producto_id" name="editar_producto_id" class="form-control" hidden>

                                        <div class="mb-3">
                                            <label for="editar_nombre" class="form-label">Nombre</label>
                                            <input type="text" id="editar_nombre" name="editar_nombre" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_descripcion" class="form-label">Descripción</label>
                                            <input type="text" id="editar_descripcion" name="editar_descripcion" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_seccion" class="form-label">Sección</label>
                                            <select name="editar_seccion" id="editar_seccion" class="form-select">
                                                <option value="pizzas">Pizzas</option>
                                                <option value="bebidas">Bebidas</option>
                                                <option value="postres">Postres</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_ingredientes" class="form-label">Ingredientes</label>
                                            <select name="editar_ingredientes[]" id="editar_ingredientes" class="form-select" multiple>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_categoria" class="form-label">Categoría</label>
                                            <input type="text" id="editar_categoria" name="editar_categoria" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_precio" class="form-label">Precio</label>
                                            <input type="number" id="editar_precio" step="0.01" name="editar_precio" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_imagen" class="form-label">Imagen</label>
                                            <input type="text" id="editar_imagen" name="editar_imagen" class="form-control" placeholder="escribe la ruta en la que has pegado la imagen">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="editarProducto" id="editarProducto" class="btn btn-success" value="Editar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- TABLA DE PRODUCTOS -->
                    <div id="tablaProductos">

                        <div class="tituloTable row">
                            <div class="col-1">
                                <p class="h4">ID</p>
                            </div>
                            <div class="col-6">
                                <p class="h4">Información</p>
                            </div>
                            <div class="col-1">
                                <p class="h4">Precio</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Imagen</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Acciones</p>
                            </div>
                        </div>
    
                        <div id="contenedorDatosProductos"></div>

                    </div>
                    
                </div>

                <!-- CONTENEDOR INGREDIENTES -->
                <div id="contenedorIngredientes" class="container-fluid">
                    <button type="button" class="btn btn-primary botonAñadir" data-bs-toggle="modal" data-bs-target="#modalCrearIngrediente">
                        Crear Ingrediente
                    </button>

                    <button type="button" class="btn btn-primary botonAñadir" onclick="filtrarPorCategoria()">
                        Filtrar por categoría
                    </button>

                    <!-- Modal Crear Ingrediente -->
                    <div class="modal fade" id="modalCrearIngrediente" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear ingrediente</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCrearIngrediente" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="añadir_nombre_ingrediente" class="form-label">Nombre</label>
                                            <input type="text" id="añadir_nombre_ingrediente" name="añadir_nombre_ingrediente" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_descripcion_ingrediente" class="form-label">Descripción</label>
                                            <input type="text" id="añadir_descripcion_ingrediente" name="añadir_descripcion_ingrediente" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_precio_ingrediente" class="form-label">Precio la unidad</label>
                                            <input type="number" id="añadir_precio_ingrediente" name="añadir_precio_ingrediente" class="form-control" step="0.01">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_categoria_ingrediente" class="form-label">Categoría</label>
                                            <input type="text" id="añadir_categoria_ingrediente"  name="añadir_categoria_ingrediente" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="crearIngrediente" id="crearIngrediente" class="btn btn-success" value="Crear">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Editar Ingrediente -->
                    <div class="modal fade" id="modalEditarIngrediente" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Editar ingrediente</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioEditarIngrediente" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="text" id="editar_ingrediente_id" name="editar_ingrediente_id" hidden>

                                        <div class="mb-3">
                                            <label for="editar_nombre_ingrediente" class="form-label">Nombre</label>
                                            <input type="text" id="editar_nombre_ingrediente" name="editar_nombre_ingrediente" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_descripcion_ingrediente" class="form-label">Descripción</label>
                                            <input type="text" id="editar_descripcion_ingrediente" name="editar_descripcion_ingrediente" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_precio_ingrediente" class="form-label">Precio la unidad</label>
                                            <input type="number" id="editar_precio_ingrediente" name="editar_precio_ingrediente" class="form-control" step="0.01">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_categoria_ingrediente" class="form-label">Categoría</label>
                                            <input type="text" id="editar_categoria_ingrediente"  name="editar_categoria_ingrediente" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="editarIngrediente" id="editarIngrediente" class="btn btn-success" value="Editar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtro Ingrediente -->
                    <div class="modal fade" id="modalFiltroIngredientes" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Filtrar ingrediente</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroIngredientes" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="filtrar_ingredientes" class="form-label">Categorías</label>
                                            <select name="filtrar_ingredientes" id="filtrar_ingredientes" class="form-select">
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarIngredientes" id="filtrarIngredientes" class="btn btn-success" value="Crear">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- TABLA DE INGREDIENTES -->
                    <div id="tablaIngredientes">

                        <div class="tituloTable row">
                            <div class="col-1">
                                <p class="h4">ID</p>
                            </div>
                            <div class="col-8">
                                <p class="h4">Información</p>
                            </div>
                            <div class="col-1">
                                <p class="h4">Precio</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Acciones</p>
                            </div>
                        </div>
    
                        <div id="contenedorDatosIngredientes"></div>

                    </div>
                </div>

                <!-- CONTENEDOR OFERTAS -->
                <div id="contenedorOfertas" class="container-fluid">
                    <button type="button" class="btn btn-primary botonAñadir" data-bs-toggle="modal" data-bs-target="#modalCrearOferta">
                        Crear Oferta
                    </button>

                    <button type="button" class="btn btn-primary botonAñadir" onclick="filtrarPorTipo()">
                        Filtrar por categoría
                    </button>

                    <!-- Modal Crear Ingrediente -->
                    <div class="modal fade" id="modalCrearOferta" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear oferta</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioCrearOferta" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="añadir_nombre_oferta" class="form-label">Nombre</label>
                                            <input type="text" id="añadir_nombre_oferta" name="añadir_nombre_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_descripcion_oferta" class="form-label">Descripción</label>
                                            <input type="text" id="añadir_descripcion_oferta" name="añadir_descripcion_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_descuento_oferta" class="form-label">Descuento</label>
                                            <input type="number" id="añadir_descuento_oferta" name="añadir_descuento_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_tipo_oferta" class="form-label">Tipo de descuento</label>
                                            <select name="añadir_tipo_oferta" id="añadir_tipo_oferta" class="form-select">
                                                <option value="%">Porcentaje</option>
                                                <option value="€">Euros</option>
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_fecha_inicio_oferta" class="form-label">Fecha de inicio</label>
                                            <input type="date" id="añadir_fecha_inicio_oferta"  name="añadir_fecha_inicio_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="añadir_fecha_final_oferta" class="form-label">Fecha de fin</label>
                                            <input type="date" id="añadir_fecha_final_oferta"  name="añadir_fecha_final_oferta" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="crearOferta" id="crearOferta" class="btn btn-success" value="Crear">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Editar Oferta -->
                    <div class="modal fade" id="modalEditarOferta" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Editar oferta</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioEditarOferta" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <input type="text" id="editar_id_oferta" name="editar_ingrediente_id" hidden>

                                        <div class="mb-3">
                                            <label for="editar_nombre_oferta" class="form-label">Nombre</label>
                                            <input type="text" id="editar_nombre_oferta" name="editar_nombre_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_descripcion_oferta" class="form-label">Descripción</label>
                                            <input type="text" id="editar_descripcion_oferta" name="editar_descripcion_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_descuento_oferta" class="form-label">Descuento</label>
                                            <input type="number" id="editar_descuento_oferta" name="editar_descuento_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_tipo_oferta" class="form-label">Tipo de descuento</label>
                                            <select name="editar_tipo_oferta" id="editar_tipo_oferta" class="form-select">
                                            </select>
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_fecha_inicio_oferta" class="form-label">Fecha de inicio</label>
                                            <input type="date" id="editar_fecha_inicio_oferta"  name="editar_fecha_inicio_oferta" class="form-control">
                                        </div>

                                        <div class="mb-3">
                                            <label for="editar_fecha_final_oferta" class="form-label">Fecha de fin</label>
                                            <input type="date" id="editar_fecha_final_oferta"  name="editar_fecha_final_oferta" class="form-control">
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="editarOferta" id="editarOferta" class="btn btn-success" value="Editar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- Modal Filtro Ingrediente -->
                    <div class="modal fade" id="modalFiltroOfertas" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLongTitle">Crear producto</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>

                                <!-- Formulario dentro del modal -->
                                <form id="formularioFiltroOfertas" method="POST" enctype="multipart/form-data">
                                    <div class="modal-body">

                                        <div class="mb-3">
                                            <label for="filtrar_ofertas" class="form-label">Categorías</label>
                                            <select name="filtrar_ofertas" id="filtrar_ofertas" class="form-select">
                                                <option value="%">Prcentaje</option>
                                                <option value="€">Euros</option>
                                            </select>
                                        </div>

                                    </div>

                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                        <input type="submit" name="filtrarOfertas" id="filtrarOfertas" class="btn btn-success" value="Filtrar">
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                    <!-- TABLA DE OFERTAS -->
                    <div id="tablaOfertas">

                        <div class="tituloTable row">
                            <div class="col-1">
                                <p class="h4">ID</p>
                            </div>
                            <div class="col-5">
                                <p class="h4">Información</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Descuento</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Fechas</p>
                            </div>
                            <div class="col-2">
                                <p class="h4">Acciones</p>
                            </div>
                        </div>
    
                        <div id="contenedorDatosOfertas"></div>

                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper (JS) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

    <!-- Scripts -->
    <script src="views/admin/pedidos.js"></script>
    <script src="views/admin/usuarios.js"></script>
    <script src="views/admin/productos.js"></script>
    <script src="views/admin/ingredientes.js"></script>
    <script src="views/admin/ofertas.js"></script>

    <!-- Script de la página -->
    <script>

        // Datos del servidor Freecurrency
        const API_URL = 'https://api.freecurrencyapi.com/v1/latest';
        const API_KEY = 'fca_live_BFxDuIPgRfeyednKIiQhUNOwNlP3p21N7XxYxhhA';

        async function cargarDatosDivisas(){

            try{
                // Obtener las monedas de la api
                const url = `${API_URL}?apikey=${API_KEY}`;
                const respuesta = await fetch(url);
                const data = await respuesta.json();
                const divisas = Object.keys(data.data);

                // Obtener los datos de la página
                const selectorDivisas = document.getElementById('selectorDivisas');
                const monedaConvertida = sessionStorage.getItem('monedaConvertida');

                // Crear el selector de divisas
                divisas.forEach(divisa => {
                    const opcion = document.createElement('option');
                    opcion.value = divisa;
                    opcion.textContent = divisa;
                    selectorDivisas.appendChild(opcion);
                });

                // Preselección de moneda
                if(monedaConvertida){
                    selectorDivisas.value = monedaConvertida;
                }
            } catch (error){
                alert("Demasiadas peticiones! Vuelva a probar más tarde.");
            }

        }

        async function convertirMonedas(cantidad){

            const valorMoneda = sessionStorage.getItem('valorMoneda') ?? 1;

            console.log("Precio base: "+ cantidad +" moneda base: EUR moneda convertida: "+ valorMoneda +" precio final: "+ valorMoneda);

            // Devolver el valor final
            return cantidad * valorMoneda;
        }

        async function cargarDatosAdmin(){

            // Datos de pedidos
            const respuestaPedidos = await fetch(`?controller=api&action=obtenerDatosPedidos`, 
                {method: 'POST', headers: {'Content-Type': 'application/json'}}
            );
            const datosPedidos = await respuestaPedidos.json();

            const contenedorPedidos = document.querySelector('#datosPedidos');
            contenedorPedidos.innerHTML = `
                <h7>Pedidos</h7>
                    <br><br>
                <p><b>Cantidad de pedidos realizados:</b> ${datosPedidos.cantidadPedidos}</p>
                <p><b>Precio total de los productos comprados:</b> ${datosPedidos.precioTotalPedidos} €</p>
                <p><b>Total de dinero descontado:</b> ${datosPedidos.totalDescuentos} €</p>
            `;

            // Datos de Usuarios
            const respuestaUsuarios = await fetch(`?controller=api&action=obtenerDatosUsuarios`, 
                {method: 'POST', headers: {'Content-Type': 'application/json'}}
            );
            const datosUsuarios = await respuestaUsuarios.json();

            const contenedorUsuarios = document.querySelector('#datosUsuarios');
            contenedorUsuarios.innerHTML = `
                <h7>Usuarios</h7>
                    <br><br>
                <p><b>Usuarios registrados:</b> ${datosUsuarios.cantidadUsuarios}</p>
                <p><b>Usuarios con perfil completo:</b> ${datosUsuarios.usuariosConPerfilCompleto}</p>
                <p><b>Usuarios sin tarjeta disponible:</b> ${datosUsuarios.usuariosSinTarjeta}</p>
                    <br>
                <p><b>Usuario más fiel:</b> ${datosPedidos.mejorUsuario.mejorUsuario}</p>
                <p><b>Cantidad de dinero gastado:</b> ${datosPedidos.mejorUsuario.dineroGastado} €</p>
            `;

            // Datos de Productos
            const respuestaProductos = await fetch(`?controller=api&action=obtenerDatosProductos`, 
                {method: 'POST', headers: {'Content-Type': 'application/json'}}
            );
            const datosProductos = await respuestaProductos.json();

            const contenedorProductos = document.querySelector('#datosProductos');
            contenedorProductos.innerHTML = `
                <h7>Productos</h7>
                    <br><br>
                <p><b>Cantidad de productos disponibles:</b> ${datosProductos.cantidadProductos}</p>
                <p><b>Promedio de precio de pizzas:</b> ${datosProductos.promedioPrecioPizzas} €</p>
                <p><b>Promedio de precio de bebidas:</b> ${datosProductos.promedioPrecioBebidas} €</p>
                <p><b>Promedio de precio de postres:</b> ${datosProductos.promedioPrecioPostres} €</p>
            `;

            // Datos de Ingredientes
            const respuestaIngredientes = await fetch(`?controller=api&action=obtenerDatosIngredientes`, 
                {method: 'POST', headers: {'Content-Type': 'application/json'}}
            );
            const datosIngredientes = await respuestaIngredientes.json();

            const contenedorIngredientes = document.querySelector('#datosIngredientes');
            contenedorIngredientes.innerHTML = `
                <h7>Ingredientes</h7>
                    <br><br>
                <p><b>Cantidad de ingredientes:</b> ${datosIngredientes.cantidadIngredientes}</p>
                <p><b>Promedio de los ingredientes:</b> ${datosIngredientes.promedioPrecioIngrediente} €</p>
                <p><b>Ingrediente más caro:</b> ${datosIngredientes.ingredienteMasCaro}</p>
                <p><b>Ingrediente más barato:</b> ${datosIngredientes.ingredienteMasBarato}</p>
            `;

        }

        async function cargarDatosLogs(){

            // Obtener los logs de la sesión
            const respuestaLogs = await fetch(`?controller=api&action=obtenerLogs`, 
                {method: 'POST', headers: {'Content-Type': 'application/json'}}
            );
            const datosLogs = await respuestaLogs.json();

            // Asignar nombre al contenedor de los datosLogs
            const contenedorLogs = document.querySelector('#datosLogs');
            contenedorLogs.innerHTML = ``;

            // Mostrar el resultado por pantalla
            if(datosLogs.length === 0){
                console.log("Sin logs en la DB");
                contenedorLogs.innerHTML = "No hay logs para mostrar.";
            }else{

                console.log("Hay LOGS en DB:");
                console.log(datosLogs);

                datosLogs.forEach(log => {

                    if(log.modificado == null){
                        log.modificado = "-";
                    }

                    const row = document.createElement('div');
                    row.classList.add('datosTable', 'row');

                    row.innerHTML += `
                        <div class="col-3">
                            <p>${log.accion}</p>
                        </div>
                        <div class="col-3">
                            <p>${log.modificado}</p>
                        </div>
                        <div class="col-3">
                            <p>${log.tabla}</p>
                        </div>
                        <div class="col-3">
                            <p>${log.fecha}</p>
                        </div>
                    `;

                    contenedorLogs.appendChild(row);

                });

            }

        }

        const contenedorDefault = document.getElementById('contenedorDefault');
        const contenedorPedidos = document.getElementById('contenedorPedidos');
        const contenedorUsuarios = document.getElementById('contenedorUsuarios');
        const contenedorProductos = document.getElementById('contenedorProductos');
        const contenedorIngredientes = document.getElementById('contenedorIngredientes');
        const contenedorOfertas = document.getElementById('contenedorOfertas');

        // Carga por defecto de la página
        document.addEventListener("DOMContentLoaded", () => {

            contenedorDefault.style.display = 'block';
            contenedorPedidos.style.display = 'none';
            contenedorUsuarios.style.display = 'none';
            contenedorProductos.style.display = 'none';
            contenedorIngredientes.style.display = 'none';
            contenedorOfertas.style.display = 'none';

            cargarDatosDivisas();
            cargarDatosAdmin();
            cargarDatosLogs();

        });
        
        // Botones laterales
        document.querySelector('#botonObtenerAllPedidos').addEventListener('click', function() {
            contenedorDefault.style.display = 'none';
            contenedorPedidos.style.display = 'block';
            contenedorUsuarios.style.display = 'none';
            contenedorProductos.style.display = 'none';
            contenedorIngredientes.style.display = 'none';
            contenedorOfertas.style.display = 'none';
        });
        document.querySelector('#botonObtenerAllUsuarios').addEventListener('click', function() {
            contenedorDefault.style.display = 'none';
            contenedorPedidos.style.display = 'none';
            contenedorUsuarios.style.display = 'block';
            contenedorProductos.style.display = 'none';
            contenedorIngredientes.style.display = 'none';
            contenedorOfertas.style.display = 'none';
        });
        document.querySelector('#botonObtenerAllProductos').addEventListener('click', function() {
            contenedorDefault.style.display = 'none';
            contenedorPedidos.style.display = 'none';
            contenedorUsuarios.style.display = 'none';
            contenedorProductos.style.display = 'block';
            contenedorIngredientes.style.display = 'none';
            contenedorOfertas.style.display = 'none';
        });
        document.querySelector('#botonObtenerAllIngredientes').addEventListener('click', function() {
            contenedorDefault.style.display = 'none';
            contenedorPedidos.style.display = 'none';
            contenedorUsuarios.style.display = 'none';
            contenedorProductos.style.display = 'none';
            contenedorIngredientes.style.display = 'block';
            contenedorOfertas.style.display = 'none';
        });
        document.querySelector('#botonObtenerAllOfertas').addEventListener('click', function() {
            contenedorDefault.style.display = 'none';
            contenedorPedidos.style.display = 'none';
            contenedorUsuarios.style.display = 'none';
            contenedorProductos.style.display = 'none';
            contenedorIngredientes.style.display = 'none';
            contenedorOfertas.style.display = 'block';
        });

        // Cambio de divisa con el selector
        document.getElementById('selectorDivisas').addEventListener('change', async (event) => {

            // Obtener la moneda a la que se quiere convertir
            sessionStorage.setItem('monedaConvertida', event.target.value);

            // Obtener el valor de conversión
            try{

                const url = `${API_URL}?apikey=${API_KEY}&base_currency=EUR`;
                const respuesta = await fetch(url);
                const data = await respuesta.json();
                const valorConversion = data.data[event.target.value];

                // Guardar el valor de la conversión en sessionStorage
                sessionStorage.setItem('valorMoneda', valorConversion);

            } catch (error){
                alert("Demasiadas peticiones. Vuelva a probar más tarde");
            }            

            
        });


    </script>

</body>
</html>
